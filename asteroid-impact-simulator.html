<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asteroid Impact Simulator - Interactive Calculator</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .simulator-container {
            max-width: 1000px;
            margin: 40px auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #333;
        }
        
        .control-group input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #ddd;
            outline: none;
        }
        
        .control-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .value-display {
            display: inline-block;
            background: #f0f0f0;
            padding: 4px 12px;
            border-radius: 4px;
            font-family: monospace;
            margin-left: 10px;
        }
        
        #visualization {
            position: relative;
            width: 100%;
            height: 500px;
            background: #e8f4f8;
            border: 2px solid #333;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        #map-canvas {
            width: 100%;
            height: 100%;
        }
        
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .result-card {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #2196F3;
        }
        
        .result-card h3 {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
        }
        
        .result-card .value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        
        .result-card .unit {
            font-size: 14px;
            color: #999;
        }
        
        .comparison {
            margin-top: 20px;
            padding: 15px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 4px;
        }
        
        .warning {
            background: #f8d7da;
            border-left-color: #dc3545;
            color: #721c24;
        }
        
        .disclaimer {
            margin-top: 20px;
            padding: 15px;
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .controls {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="phenomenon-header">
        <div class="container">
            <h1>üåç Asteroid Impact Simulator</h1>
            <p class="tagline">Interactive calculator for planetary defense education</p>
        </div>
    </div>

    <div class="breadcrumb">
        <div class="container">
            <a href="index.html">‚Üê Back to Index</a> | 
            <a href="tunguska-event.html">Related: Tunguska Event</a>
        </div>
    </div>

    <main class="container">
        <div class="simulator-container">
            <h2>Impact Parameters</h2>
            
            <div class="controls">
                <div>
                    <div class="control-group">
                        <label>
                            Asteroid Diameter: <span class="value-display" id="diameter-display">60 m</span>
                        </label>
                        <input type="range" id="diameter" min="10" max="1000" value="60" step="5">
                        <small>10m (car) to 1km (city-killer)</small>
                    </div>
                    
                    <div class="control-group">
                        <label>
                            Velocity: <span class="value-display" id="velocity-display">15 km/s</span>
                        </label>
                        <input type="range" id="velocity" min="11" max="72" value="15" step="1">
                        <small>11 km/s (minimum) to 72 km/s (maximum)</small>
                    </div>
                    
                    <div class="control-group">
                        <label>Entry Angle: <span class="value-display" id="angle-display">45¬∞</span></label>
                        <input type="range" id="angle" min="15" max="90" value="45" step="5">
                        <small>15¬∞ (shallow) to 90¬∞ (vertical)</small>
                    </div>
                </div>
                
                <div>
                    <div class="control-group">
                        <label>Composition</label>
                        <select id="composition">
                            <option value="ice" data-density="917">Icy Comet (917 kg/m¬≥)</option>
                            <option value="stony" data-density="2600" selected>Stony Asteroid (2,600 kg/m¬≥)</option>
                            <option value="iron" data-density="7800">Iron Asteroid (7,800 kg/m¬≥)</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>Impact Location</label>
                        <select id="location">
                            <option value="nyc" data-density="11000">New York City (11,000/km¬≤)</option>
                            <option value="tokyo" data-density="15000">Tokyo (15,000/km¬≤)</option>
                            <option value="london" data-density="5700">London (5,700/km¬≤)</option>
                            <option value="paris" data-density="8900">Paris (8,900/km¬≤)</option>
                            <option value="la" data-density="3200">Los Angeles (3,200/km¬≤)</option>
                            <option value="mumbai" data-density="31700">Mumbai (31,700/km¬≤)</option>
                            <option value="desert" data-density="0" selected>Remote Desert (0/km¬≤)</option>
                            <option value="ocean" data-density="0">Ocean (0/km¬≤)</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <button onclick="calculate()" style="width: 100%; padding: 12px; background: #2196F3; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; margin-top: 10px;">
                            üí• Calculate Impact
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="visualization">
                <canvas id="map-canvas"></canvas>
            </div>
            
            <div class="results" id="results"></div>
            
            <div id="comparison" class="comparison" style="display: none;"></div>
            
            <div class="disclaimer">
                <strong>‚ö†Ô∏è Educational Simulation</strong><br>
                This calculator uses simplified physics models for educational purposes. Real impact outcomes depend on many additional factors (terrain, atmospheric conditions, asteroid structure, etc.). For precise calculations, use the <a href="https://impact.ese.ic.ac.uk/ImpactEarth/" target="_blank">Imperial College Impact Calculator</a>.
                <br><br>
                <strong>Frequency:</strong> Tunguska-class events (~10-30 MT) occur approximately once every 300-1,000 years. NASA tracks 95% of city-killer asteroids. Modern detection gives years of warning for deflection missions.
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p><em>Interactive simulator by Zora üåÄ for planetary defense education</em></p>
            <p><a href="index.html">‚Üê Return to Index</a> | <a href="tunguska-event.html">Learn about Tunguska Event</a></p>
        </div>
    </footer>

    <script>
        // Physics constants
        const G = 6.674e-11; // Gravitational constant
        const R_EARTH = 6371; // Earth radius in km
        const ATM_SCALE_HEIGHT = 7.16; // km
        const TNT_TO_JOULES = 4.184e15; // 1 megaton TNT in joules
        
        // Update display values
        document.getElementById('diameter').addEventListener('input', (e) => {
            document.getElementById('diameter-display').textContent = e.target.value + ' m';
        });
        
        document.getElementById('velocity').addEventListener('input', (e) => {
            document.getElementById('velocity-display').textContent = e.target.value + ' km/s';
        });
        
        document.getElementById('angle').addEventListener('input', (e) => {
            document.getElementById('angle-display').textContent = e.target.value + '¬∞';
        });
        
        function getAirburstAltitude(diameter_m, velocity_km_s, density_kg_m3, composition) {
            // Iron asteroids reach ground, comets burst very high, stony in between
            if (composition === 'iron' && diameter_m > 50) {
                return 0; // Reaches ground
            }
            
            const strength = composition === 'ice' ? 1e5 : (composition === 'stony' ? 1e6 : 5e7); // Pa
            const atm_density = 1.225; // kg/m¬≥
            const velocity_m_s = velocity_km_s * 1000;
            
            const ram_pressure = 0.5 * atm_density * velocity_m_s * velocity_m_s;
            
            // Hills-Goda simplified
            const altitude_km = -ATM_SCALE_HEIGHT * Math.log(strength / ram_pressure);
            
            return Math.max(0, Math.min(altitude_km, 50));
        }
        
        function getKineticEnergy(diameter_m, density_kg_m3, velocity_km_s) {
            const radius_m = diameter_m / 2;
            const volume_m3 = (4/3) * Math.PI * Math.pow(radius_m, 3);
            const mass_kg = volume_m3 * density_kg_m3;
            const velocity_m_s = velocity_km_s * 1000;
            
            const energy_J = 0.5 * mass_kg * velocity_m_s * velocity_m_s;
            const energy_MT = energy_J / TNT_TO_JOULES;
            
            return {
                mass_kg: mass_kg,
                energy_J: energy_J,
                energy_MT: energy_MT
            };
        }
        
        function getBlastRadius(energy_MT, altitude_km) {
            // Simplified Glasstone scaling for 5 psi overpressure (destroys most buildings)
            const base_radius_km = 2.2 * Math.pow(energy_MT, 0.33);
            
            // Altitude effect (optimal burst height maximizes damage)
            const optimal_altitude_km = 0.4 * base_radius_km;
            const altitude_factor = altitude_km === 0 ? 0.7 : Math.exp(-Math.abs(altitude_km - optimal_altitude_km) / 5);
            
            return base_radius_km * Math.max(altitude_factor, 0.3);
        }
        
        function getCasualties(blast_radius_km, population_density_per_km2) {
            const affected_area_km2 = Math.PI * blast_radius_km * blast_radius_km;
            const population = affected_area_km2 * population_density_per_km2;
            
            // Simplified casualty model (50% fatality within blast radius)
            const fatalities = population * 0.5;
            const injuries = population * 0.8;
            
            return {
                affected_area: affected_area_km2,
                population: population,
                fatalities: fatalities,
                injuries: injuries
            };
        }
        
        function formatNumber(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(1) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(1) + 'K';
            return num.toFixed(0);
        }
        
        function drawVisualization(blast_radius_km, altitude_km, location_name) {
            const canvas = document.getElementById('map-canvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            
            // Scale: 1 px = 0.1 km
            const scale = Math.min(canvas.width, canvas.height) / (blast_radius_km * 2.5);
            
            // Clear canvas
            ctx.fillStyle = '#e8f4f8';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw city outline (simplified circle)
            ctx.strokeStyle = '#999';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.arc(centerX, centerY, 30 * scale, 0, 2 * Math.PI);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Draw blast radius
            const blastRadiusPx = blast_radius_km * scale;
            
            // Outer circle (minor damage)
            ctx.fillStyle = 'rgba(255, 152, 0, 0.2)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, blastRadiusPx * 1.5, 0, 2 * Math.PI);
            ctx.fill();
            
            // Middle circle (major damage)
            ctx.fillStyle = 'rgba(255, 87, 34, 0.3)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, blastRadiusPx, 0, 2 * Math.PI);
            ctx.fill();
            
            // Inner circle (total destruction)
            ctx.fillStyle = 'rgba(244, 67, 54, 0.5)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, blastRadiusPx * 0.5, 0, 2 * Math.PI);
            ctx.fill();
            
            // Draw impact point
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 5, 0, 2 * Math.PI);
            ctx.fill();
            
            // Draw altitude indicator (if airburst)
            if (altitude_km > 0) {
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.setLineDash([3, 3]);
                ctx.beginPath();
                ctx.moveTo(centerX, centerY - 50);
                ctx.lineTo(centerX, centerY);
                ctx.stroke();
                ctx.setLineDash([]);
                
                ctx.fillStyle = '#333';
                ctx.font = '12px sans-serif';
                ctx.fillText(`Airburst: ${altitude_km.toFixed(1)} km`, centerX + 10, centerY - 40);
            }
            
            // Legend
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px sans-serif';
            ctx.fillText('Blast Zones:', 20, 30);
            ctx.font = '12px sans-serif';
            
            ctx.fillStyle = 'rgba(244, 67, 54, 0.5)';
            ctx.fillRect(20, 40, 15, 15);
            ctx.fillStyle = '#333';
            ctx.fillText('Total destruction', 40, 52);
            
            ctx.fillStyle = 'rgba(255, 87, 34, 0.3)';
            ctx.fillRect(20, 65, 15, 15);
            ctx.fillStyle = '#333';
            ctx.fillText('Major damage (5 psi)', 40, 77);
            
            ctx.fillStyle = 'rgba(255, 152, 0, 0.2)';
            ctx.fillRect(20, 90, 15, 15);
            ctx.fillStyle = '#333';
            ctx.fillText('Minor damage', 40, 102);
            
            // Scale bar
            const scaleBarKm = 10;
            const scaleBarPx = scaleBarKm * scale;
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(canvas.width - 100, canvas.height - 30);
            ctx.lineTo(canvas.width - 100 + scaleBarPx, canvas.height - 30);
            ctx.stroke();
            
            ctx.fillStyle = '#333';
            ctx.font = '12px sans-serif';
            ctx.fillText(`${scaleBarKm} km`, canvas.width - 100, canvas.height - 10);
        }
        
        function calculate() {
            const diameter_m = parseFloat(document.getElementById('diameter').value);
            const velocity_km_s = parseFloat(document.getElementById('velocity').value);
            const angle_deg = parseFloat(document.getElementById('angle').value);
            const composition = document.getElementById('composition').value;
            const density_kg_m3 = parseFloat(document.getElementById('composition').selectedOptions[0].dataset.density);
            const location = document.getElementById('location');
            const location_name = location.selectedOptions[0].text;
            const population_density = parseFloat(location.selectedOptions[0].dataset.density);
            
            // Calculate impact effects
            const altitude_km = getAirburstAltitude(diameter_m, velocity_km_s, density_kg_m3, composition);
            const energy = getKineticEnergy(diameter_m, density_kg_m3, velocity_km_s);
            const blast_radius_km = getBlastRadius(energy.energy_MT, altitude_km);
            const casualties = getCasualties(blast_radius_km, population_density);
            
            // Display results
            const resultsHTML = `
                <div class="result-card">
                    <h3>Impact Energy</h3>
                    <div class="value">${energy.energy_MT.toFixed(1)}</div>
                    <div class="unit">megatons TNT</div>
                </div>
                
                <div class="result-card">
                    <h3>Airburst Altitude</h3>
                    <div class="value">${altitude_km === 0 ? 'Ground' : altitude_km.toFixed(1)}</div>
                    <div class="unit">${altitude_km === 0 ? 'impact' : 'km above ground'}</div>
                </div>
                
                <div class="result-card">
                    <h3>Blast Radius (5 psi)</h3>
                    <div class="value">${blast_radius_km.toFixed(1)}</div>
                    <div class="unit">km</div>
                </div>
                
                <div class="result-card">
                    <h3>Affected Area</h3>
                    <div class="value">${casualties.affected_area.toFixed(0)}</div>
                    <div class="unit">km¬≤</div>
                </div>
                
                <div class="result-card ${casualties.fatalities > 0 ? 'warning' : ''}">
                    <h3>Estimated Casualties</h3>
                    <div class="value">${casualties.fatalities > 0 ? formatNumber(casualties.fatalities) : '0'}</div>
                    <div class="unit">${casualties.fatalities > 0 ? 'fatalities' : 'fatalities (unpopulated)'}</div>
                </div>
                
                <div class="result-card ${casualties.injuries > 0 ? 'warning' : ''}">
                    <h3>Estimated Injuries</h3>
                    <div class="value">${casualties.injuries > 0 ? formatNumber(casualties.injuries) : '0'}</div>
                    <div class="unit">injuries</div>
                </div>
            `;
            
            document.getElementById('results').innerHTML = resultsHTML;
            
            // Comparison
            let comparisonText = '';
            if (energy.energy_MT < 0.1) {
                comparisonText = `<strong>Comparison:</strong> This is a <strong>small event</strong>, comparable to large conventional bombs. Damage would be localized.`;
            } else if (energy.energy_MT < 1) {
                comparisonText = `<strong>Comparison:</strong> Energy similar to a large tactical nuclear weapon. Would cause significant local destruction.`;
            } else if (energy.energy_MT >= 10 && energy.energy_MT <= 30) {
                comparisonText = `<strong>Comparison:</strong> <strong>Tunguska-class event</strong> (1908). Original Tunguska explosion (10-30 MT) flattened 2,000 km¬≤ of forest but killed almost no one due to remote location. Over ${location_name}, casualties would be catastrophic.`;
            } else if (energy.energy_MT > 30 && energy.energy_MT < 100) {
                comparisonText = `<strong>Comparison:</strong> Larger than Tunguska. Energy approaching the largest thermonuclear weapons ever tested (Tsar Bomba: 50 MT). Regional devastation.`;
            } else if (energy.energy_MT >= 100) {
                comparisonText = `<strong>Comparison:</strong> <strong>City-killer asteroid</strong>. This would cause regional-to-continental destruction. Fortunately, NASA tracks 95% of asteroids this size, providing years-to-decades of warning.`;
            }
            
            document.getElementById('comparison').innerHTML = comparisonText;
            document.getElementById('comparison').style.display = 'block';
            
            // Draw visualization
            drawVisualization(blast_radius_km, altitude_km, location_name);
        }
        
        // Initial calculation on load
        window.addEventListener('load', () => {
            calculate();
        });
    </script>
</body>
</html>
